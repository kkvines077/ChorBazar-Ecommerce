<!DOCTYPE html>
<html>
<head>
  <title>Cart - MyStore</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>

  <header>
    <div class="logo">MyStore</div>
    <a href="index.html" class="cart">üè† Home</a>
  </header>

  <main>
    <h2>Your Cart</h2>
    <div id="cart-items"></div>
    <h3>Total: ‚Çπ<span id="total">0</span></h3>
    <button onclick="checkout()">Proceed to Pay</button>
  </main>

  <script>
    // Check if logged in
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      alert("Please login first.");
      window.location.href = "login.html";
    }

    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const productMap = {
      1: { name: "Wireless Headphones", price: 1999 },
      2: { name: "Smart Watch", price: 2499 },
      3: { name: "Bluetooth Speaker", price: 1499 }
    };

    let total = 0;
    const div = document.getElementById("cart-items");

    cart.forEach(id => {
      const p = productMap[id];
      total += p.price;
      div.innerHTML += `<div>${p.name} - ‚Çπ${p.price}</div>`;
    });

    document.getElementById("total").innerText = total;

    function checkout() {
      const options = {
        key: "rzp_test_yourkeyhere", // Replace with your Razorpay test key
        amount: total * 100,
        currency: "INR",
        name: "MyStore",
        description: "Shopping Payment",
        handler: function (response) {
          alert("Payment Success! ID: " + response.razorpay_payment_id);
          localStorage.removeItem("cart");
          window.location.href = "thankyou.html";
        },
        prefill: {
          name: user.name || "Customer",
          email: user.email
        },
        theme: { color: "#3399cc" }
      };

      const rzp = new Razorpay(options);
      rzp.open();
    }
  </script>

</body>
</html>
